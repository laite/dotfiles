Harjoitukset3

Tehtävä 1.

Tee Demo2:n ensimmäiseen tehtävään sisääntulevan tiedon tarkistus. Tämä tarkoittaa sitä että kun otat selaimen osoiteriviltä sivua kuvaavan muuttujan arvon talteen $_GET['nro'] -superglobaalimuuttujalla, tarkistat mitä tietoa $_GET['nro'] sisältää. Tee tarkistus siten että sisääntulevassa tiedossa ei saa esiintyä muita merkkejä kuin 1-2kpl numeroita 0-9. Tarkistus onnistuu preg_match() -funktion ja säännönmukaisen lausekkeen (regular expression) avulla. Tässä tapauksessa oikea säännönmukainen lauseke on "/^[0-9]{1,2}$/". Ehkäpä yksinkertaisin tapa estää väärän tiedon lisääminen url-osoitteeseen on poistua index.php -sivulta exit() -funktion avulla jos sisääntuleva tieto ei toteuta säännönmukaista lauseketta. Ratkaisu voisi näyttää tältä

Tehtävä 2.

Laajenna Demo2:n toista tehtävää siten että tallennat lomakeelta saadut ohjelmointikielten nimet cookieen (t2_setcookie.php) ja tulostat ne cookiesta sivulle (t2_usecookie.php). Huomaa että et voi tallentaa taulukkomuuttujaa suoraan cookieen koska setcookie()-funktio vaatii parametrikseen merkkijonon. Tee silmukka jolla asetat arvot taulukkomuuttujasta useampaan cookieen. Ratkaisu voisi näyttää tältä

Tehtävä 3.

Laajenna "Lomakkeiden käsittely" -sivulla olevaa erittäin yksinkertaista kirjaumissovellusta (Esimerkki 2) siten että teet kirjautumisen session kautta. Tallenna kirjautujan tiedot lomakkeelta sessiomuuttujaan ja hae ne sieltä kirjautumissivulle. Miten session kautta toimiva kirjautuminen eroaa toiminnaltaan ilman sessiota tehdystä kirjautumisesta? Session avulla kirjautuminen näyttää tältä ja ilman sessiota tältä. Tunnus qwerty, salasana qwerty.

Tehtävä 4.

Kehitä Demo2:n tehtävää 6 niin että teet siihen kirjautumisen session avulla. Huomaa että sovelluksessa on nyt useampi kuin yksi sivu joilla kirjautumisen on pysyttävä voimassa. Tee lisäksi valikkoon uusi linkki josta pääsee kirjautumaan ulos. Ratkaisu voisi näyttää tältä Tunnus qwerty, salasana qwerty.

Tehtävä 5.

Tee istunnon toimintaa havainnollistava skripti sessiolaskuri.php, joka näyttää session id:n ja laskee kuinka monta kertaa olet vieraillut istunnossa.

Ohje: Aloita istunto. Jos (if) istuntomuuttujaa 'laskuri' ei ole määritelty (!isset), määritellään se ja annetaan arvoksi 0, sijoitetaan muuttujaan $id valmisfunktio (etsi manuaalista) joka palauttaa session id:n ja tulostetaan että olet ensimmäistä kertaa sessiossa $id. Muuten (else) lisätään istuntomuuttujan arvoa yhdellä, sijoitetaan muuttujaan $id valmisfunktio joka palauttaa session id:n, sijoitetaan istuntomuuttujan arvo muuttujaan $lukema ja tulostetaan että olet olet ollut aiemminkin sessiossa $id ja aiempien vierailujesi määrä on $lukema. Tee myös sessiolaskuri_unset.php, jolla voit nollata laskurin session aikana. Miten laskurin käy kun suljet selaimen ja avaat selaimen ja laskurin uudelleen, mistä johtuu? Ratkaisu voisi näyttää tältä

Tehtävä 6.

Luo PHP:llä taulukko jossa on kolme vuosilukua. Tee kolme metodia, jotka ottavat parametrikseen ko. taulukon. Ensimmäinen metodi palauttaa suurimman vuosiluvun, toinen metodi palauttaa pienimmän vuosiluvun (Vihje: Sijoita ekan indeksin luku muuttujaan "suurin" ja käy vuosiluvut läpi silmukalla ja vertaa ovatko muut alkiot suurempia kuin "suurin") ja kolmas metodi palauttaa vuosilukujen keskiarvon (Vihje: array_sum(), count()). Tee metodeista funktiokirjasto (oma tiedosto jossa vain nämä kolme metodia) ja testaa metodien toiminta tiedostossa metodikoe.php johon incluudaat funktiokirjaston. Tee funktiokirjastossa oleville funktioille vielä PHPDoc -standardin mukaiset kommentit.

Tehtävä 7. extratehtävä

Tutki oheista huippuyksinkertaista ostoskoriesimerkkiä (ostoskori.zip). Laita esimerkki toimimaan ja kommentoi se perusteellisesti, niin että ymmärrät sen toiminnan. Koita laajentaa esimerkkiä tekemällä siihen mahdollisuus poistaa tuotteita ostoskorista. Ratkaisu voisi näyttää tältä.

Tehtävä 8. extratehtävä

Kehitä esimerkissä2 esitettyä kielen valintaa session avulla. Tehdään sivustolle kieliversiot eli etusivulla olevien muuttujien kieli otetaan kielitiedostosta jonka käyttäjä valitsee. Tee kaksi kielitiedostoa, fi.php ja en.php. Laita molempiin pari muuttujaa joihin sijoitat sanat suomeksi ja englanniksi. Etusivulle incluudataan se kielitiedosto jonka käyttäjä on valinnut. Toteuta tämä niin että käyttäjä näkee sivut viimeksi valitsemallaan kielellä vaikka olisi välillä sulkenut selaimen (oletetaan että cookiet on sallittu).
